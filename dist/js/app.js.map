{"version":3,"file":"app.js","sources":["../../app/js/main.js"],"sourcesContent":["// @ts-nocheck\n/* global firebase */\n\nconst App = {\n  init() {\n    const that = this\n    const firebaseConfig = {\n      apiKey: 'AIzaSyCmEjhSDdqEsmIdxe9VN4GI7IxTD2LhU4I',\n      authDomain: 'testproject-48d5e.firebaseapp.com',\n      databaseURL: 'https://testproject-48d5e.firebaseio.com',\n      projectId: 'testproject-48d5e',\n      storageBucket: 'testproject-48d5e.appspot.com',\n      messagingSenderId: '121120459695',\n      appId: '1:121120459695:web:e8ecc54371f88ce6'\n    }\n\n    firebase.initializeApp(firebaseConfig)\n    this.database = firebase.firestore()\n    const provider = new firebase.auth.FacebookAuthProvider()\n\n    provider.setCustomParameters({\n      display: 'popup'\n    })\n\n    firebase.auth().onAuthStateChanged(function(user) {\n      if (user) {\n        const html = `\n          <div class=\"header\">\n            <button class=\"logout-btn firebase-btn\">Выйти</button>\n          </div>\n          <div class=\"page\">\n            <div class=\"page__title\">Добро пожаловать, ${user.displayName}!</div>\n            <div class=\"page__subtitle\">Оставьте след в истории:</div>\n            <input class=\"page__input\">\n            <button class=\"send firebase-btn\">Отправить</button>\n            <div class=\"list\"></div>\n          </div>\n        `\n\n        $('#app').html(html)\n        that.getList()\n      } else {\n        $('#app').html('<button class=\"auth-btn firebase-btn\">Войти</button>')\n      }\n    })\n\n    $('#app').on('click', '.auth-btn', function() {\n      firebase.auth().signInWithPopup(provider)\n    })\n\n    $('#app').on('click', '.logout-btn', function() {\n      firebase.auth().signOut()\n    })\n\n    $('#app').on('click', '.send', function() {\n      const val = $('.page__input').val()\n\n      if (val.length) {\n        $('.page__input').val('')\n        that.database\n          .collection('sandbox')\n          .add({\n            user: firebase.auth().currentUser.uid,\n            text: val,\n            created: firebase.firestore.FieldValue.serverTimestamp()\n          })\n          .then(function(docRef) {\n            // eslint-disable-next-line\n            console.log('Document written with ID: ', docRef.id)\n            that.getList()\n          })\n          .catch(function(error) {\n            // eslint-disable-next-line\n            console.error('Error adding document: ', error)\n          })\n      }\n    })\n\n    $('#app').on('click', '.item__remove', function() {\n      that.database\n        .collection('sandbox')\n        .doc($(this).data('id'))\n        .delete()\n        .then(() => {\n          $(this)\n            .parent()\n            .remove()\n        })\n        .catch(error => {\n          // eslint-disable-next-line\n          console.error('Error removing document: ', error)\n        })\n    })\n  },\n\n  getList() {\n    this.database\n      .collection('sandbox')\n      .orderBy('created', 'desc')\n      .get()\n      .then(querySnapshot => {\n        const list = querySnapshot.docs.map(\n          item =>\n            `<div class=\"item\">${item.data().text}${\n              item.data().user === firebase.auth().currentUser.uid\n                ? `<span\n                  class=\"item__remove\"\n                  data-id=\"${item.id}\"\n                >\n                  +\n                </span>`\n                : ''\n            }</div>`\n        )\n\n        $('.list').html(list.join(''))\n      })\n  }\n}\n\n$('document').ready(function() {\n  App.init()\n})\n"],"names":["App","that","firebaseConfig","initializeApp","database","firebase","firestore","provider","auth","FacebookAuthProvider","setCustomParameters","onAuthStateChanged","user","html","displayName","getList","on","signInWithPopup","signOut","val","$","length","collection","add","currentUser","uid","FieldValue","serverTimestamp","then","docRef","log","id","catch","error","doc","data","delete","parent","remove","orderBy","get","list","querySnapshot","docs","map","item","text","join","ready","init"],"mappings":";;;AAAA;;;AAGA,IAAMA,MAAM;MAAA,kBACH;QACCC,OAAO,IAAb;QACMC,iBAAiB;cACb,yCADa;kBAET,mCAFS;mBAGR,0CAHQ;iBAIV,mBAJU;qBAKN,+BALM;yBAMF,cANE;aAOd;KAPT;;aAUSC,aAAT,CAAuBD,cAAvB;SACKE,QAAL,GAAgBC,SAASC,SAAT,EAAhB;QACMC,WAAW,IAAIF,SAASG,IAAT,CAAcC,oBAAlB,EAAjB;;aAESC,mBAAT,CAA6B;eAClB;KADX;;aAISF,IAAT,GAAgBG,kBAAhB,CAAmC,UAASC,IAAT,EAAe;UAC5CA,IAAJ,EAAU;YACFC,6TAK2CD,KAAKE,WALhD,kZAAN;;UAaE,MAAF,EAAUD,IAAV,CAAeA,IAAf;aACKE,OAAL;OAfF,MAgBO;UACH,MAAF,EAAUF,IAAV,CAAe,sDAAf;;KAlBJ;;MAsBE,MAAF,EAAUG,EAAV,CAAa,OAAb,EAAsB,WAAtB,EAAmC,YAAW;eACnCR,IAAT,GAAgBS,eAAhB,CAAgCV,QAAhC;KADF;;MAIE,MAAF,EAAUS,EAAV,CAAa,OAAb,EAAsB,aAAtB,EAAqC,YAAW;eACrCR,IAAT,GAAgBU,OAAhB;KADF;;MAIE,MAAF,EAAUF,EAAV,CAAa,OAAb,EAAsB,OAAtB,EAA+B,YAAW;UAClCG,MAAMC,EAAE,cAAF,EAAkBD,GAAlB,EAAZ;;UAEIA,IAAIE,MAAR,EAAgB;UACZ,cAAF,EAAkBF,GAAlB,CAAsB,EAAtB;aACKf,QAAL,CACGkB,UADH,CACc,SADd,EAEGC,GAFH,CAEO;gBACGlB,SAASG,IAAT,GAAgBgB,WAAhB,CAA4BC,GAD/B;gBAEGN,GAFH;mBAGMd,SAASC,SAAT,CAAmBoB,UAAnB,CAA8BC,eAA9B;SALb,EAOGC,IAPH,CAOQ,UAASC,MAAT,EAAiB;;kBAEbC,GAAR,CAAY,4BAAZ,EAA0CD,OAAOE,EAAjD;eACKhB,OAAL;SAVJ,EAYGiB,KAZH,CAYS,UAASC,KAAT,EAAgB;;kBAEbA,KAAR,CAAc,yBAAd,EAAyCA,KAAzC;SAdJ;;KALJ;;MAwBE,MAAF,EAAUjB,EAAV,CAAa,OAAb,EAAsB,eAAtB,EAAuC,YAAW;;;WAC3CZ,QAAL,CACGkB,UADH,CACc,SADd,EAEGY,GAFH,CAEOd,EAAE,IAAF,EAAQe,IAAR,CAAa,IAAb,CAFP,EAGGC,MAHH,GAIGR,IAJH,CAIQ,YAAM;UACR,KAAF,EACGS,MADH,GAEGC,MAFH;OALJ,EASGN,KATH,CASS,iBAAS;;gBAENC,KAAR,CAAc,2BAAd,EAA2CA,KAA3C;OAXJ;KADF;GA3EQ;SAAA,qBA4FA;SACH7B,QAAL,CACGkB,UADH,CACc,SADd,EAEGiB,OAFH,CAEW,SAFX,EAEsB,MAFtB,EAGGC,GAHH,GAIGZ,IAJH,CAIQ,yBAAiB;UACfa,OAAOC,cAAcC,IAAd,CAAmBC,GAAnB,CACX;sCACuBC,KAAKV,IAAL,GAAYW,IADnC,IAEID,KAAKV,IAAL,GAAYvB,IAAZ,KAAqBP,SAASG,IAAT,GAAgBgB,WAAhB,CAA4BC,GAAjD,kFAGeoB,KAAKd,EAHpB,0EAOI,EATR;OADW,CAAb;;QAcE,OAAF,EAAWlB,IAAX,CAAgB4B,KAAKM,IAAL,CAAU,EAAV,CAAhB;KAnBJ;;CA7FJ;;AAqHA3B,EAAE,UAAF,EAAc4B,KAAd,CAAoB,YAAW;MACzBC,IAAJ;CADF;;;;"}